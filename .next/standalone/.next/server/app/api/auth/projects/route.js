"use strict";(()=>{var e={};e.id=190,e.ids=[190],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2305:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>j});var o={};r.r(o),r.d(o,{GET:()=>u,POST:()=>p,dynamic:()=>c});var a=r(9303),s=r(8716),n=r(670),i=r(7070);let c="force-dynamic";async function u(e){try{let{searchParams:t}=new URL(e.url),o=t.get("userId");if(!o)return i.NextResponse.json({message:"ID do usu\xe1rio \xe9 obrigat\xf3rio"},{status:400});let{PrismaClient:a}=await Promise.resolve().then(r.t.bind(r,3524,23)),s=new a;try{let e=(await s.projectMember.findMany({where:{userId:o},include:{project:{select:{id:!0,name:!0,description:!0,createdAt:!0,updatedAt:!0}}}})).map(e=>({...e.project,role:e.role,joinedAt:e.joinedAt}));return i.NextResponse.json(e)}finally{await s.$disconnect()}}catch(e){return console.error("Erro ao buscar projetos:",e),i.NextResponse.json({message:"Erro interno do servidor"},{status:500})}}async function p(e){try{let{name:t,description:o,userId:a}=await e.json();if(!t||!a)return i.NextResponse.json({message:"Nome do projeto e ID do usu\xe1rio s\xe3o obrigat\xf3rios"},{status:400});let{PrismaClient:s}=await Promise.resolve().then(r.t.bind(r,3524,23)),n=new s;try{let e=await n.$transaction(async e=>{let r=await e.project.create({data:{name:t.trim(),description:o?.trim()||null,ownerId:a,createdAt:new Date,updatedAt:new Date}}),s=await e.projectMember.create({data:{projectId:r.id,userId:a,role:"GESTOR",status:"ATIVO",joinedAt:new Date,updatedAt:new Date}});return{project:r,projectMember:s}});return i.NextResponse.json({message:"Projeto criado com sucesso",project:e.project,role:e.projectMember.role})}finally{await n.$disconnect()}}catch(e){return console.error("Erro ao criar projeto:",e),i.NextResponse.json({message:"Erro interno do servidor"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/projects/route",pathname:"/api/auth/projects",filename:"route",bundlePath:"app/api/auth/projects/route"},resolvedPagePath:"/Users/jvalegri/tcc-jvalegri-1/app/api/auth/projects/route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:j,serverHooks:m}=d,w="/api/auth/projects/route";function h(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:j})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[276,972],()=>r(2305));module.exports=o})();