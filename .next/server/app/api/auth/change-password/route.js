"use strict";(()=>{var e={};e.id=814,e.ids=[814],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7618:e=>{e.exports=import("bcryptjs")},1671:(e,a,t)=>{t.a(e,async(e,s)=>{try{t.r(a),t.d(a,{originalPathname:()=>m,patchFetch:()=>p,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>l});var r=t(9303),n=t(8716),o=t(670),i=t(8197),u=e([i]);i=(u.then?(await u)():u)[0];let d=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/change-password/route",pathname:"/api/auth/change-password",filename:"route",bundlePath:"app/api/auth/change-password/route"},resolvedPagePath:"/Users/jvalegri/tcc-jvalegri-1/app/api/auth/change-password/route.ts",nextConfigOutput:"standalone",userland:i}),{requestAsyncStorage:c,staticGenerationAsyncStorage:l,serverHooks:h}=d,m="/api/auth/change-password/route";function p(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:l})}s()}catch(e){s(e)}})},8197:(e,a,t)=>{t.a(e,async(e,s)=>{try{t.r(a),t.d(a,{PUT:()=>i,dynamic:()=>u});var r=t(7070),n=t(7618),o=e([n]);n=(o.then?(await o)():o)[0];let u="force-dynamic";async function i(e){try{let{userId:a,currentPassword:s,newPassword:o}=await e.json();if(!a||!s||!o)return r.NextResponse.json({message:"ID do usu\xe1rio, senha atual e nova senha s\xe3o obrigat\xf3rios"},{status:400});if(o.length<6)return r.NextResponse.json({message:"A nova senha deve ter pelo menos 6 caracteres"},{status:400});let{PrismaClient:i}=await Promise.resolve().then(t.t.bind(t,3524,23)),u=new i;try{let e=await u.user.findUnique({where:{id:a},select:{id:!0,password:!0,email:!0}});if(!e)return r.NextResponse.json({message:"Usu\xe1rio n\xe3o encontrado"},{status:404});if(!await n.default.compare(s,e.password))return r.NextResponse.json({message:"Senha atual incorreta"},{status:401});let t=await n.default.hash(o,12);return await u.user.update({where:{id:a},data:{password:t,updatedAt:new Date}}),console.log(`Senha alterada para usu\xe1rio: ${e.email}`),r.NextResponse.json({message:"Senha alterada com sucesso"})}finally{await u.$disconnect()}}catch(e){return console.error("Erro ao alterar senha:",e),r.NextResponse.json({message:"Erro interno do servidor"},{status:500})}}s()}catch(e){s(e)}})}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[276,972],()=>t(1671));module.exports=s})();